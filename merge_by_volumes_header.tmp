#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""分册合并脚本"""

import os, glob, re, sys
from docx import Document
from docx.shared import Pt, RGBColor
from docx.enum.text import WD_ALIGN_PARAGRAPH, WD_BREAK
from docx.enum.section import WD_SECTION_START
from docx.oxml.ns import qn
from docx.oxml import OxmlElement
from docxcompose.composer import Composer
from PIL import Image
import io

def extract_route_number(filename):
    match = re.search(r'L(\d+)', filename)
    return (int(match.group(1)), match.group(0)) if match else (None, None)

def get_sorted_files(directory, pattern):
    files = glob.glob(os.path.join(directory, pattern))
    file_info = []
